2024-04-25T12:03:46.869Z START RequestId: c5dadf57-f335-59f8-9cc8-81f3bbe73fa0 Version: $LATEST

2024-04-25T12:03:46.901Z 2024-04-25T12:03:46.901Z	c5dadf57-f335-59f8-9cc8-81f3bbe73fa0	INFO	Processing message 01d01090-0547-439d-94f0-7f793e3a9487

2024-04-25T12:03:46.907Z 2024-04-25T12:03:46.907Z	c5dadf57-f335-59f8-9cc8-81f3bbe73fa0	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ7TSBFAR863GJZ13MXZET',
    type: 'DEBIT',
    source: 'MANUAL_DEDUCTION',
    action: 'DELIVERY_DEDUCTION',
    userId: '3b59834f-caa4-4506-8402-e312a7c6ef5f',
    paymentBalance: 153.75,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#3b59834f-caa4-4506-8402-e312a7c6ef5f","deliveryId":"cece5173-21e4-43ea-9073-d18bb84b393e","walletSk":"cece5173-21e4-43ea-9073-d18bb84b393e"}',
    currency: 'BHD',
    amount: 9,
    vat: 0,
    oldBalance: 162.75,
    newBalance: 153.75
  }
}

2024-04-25T12:03:46.923Z 2024-04-25T12:03:46.923Z	c5dadf57-f335-59f8-9cc8-81f3bbe73fa0	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#3b59834f-caa4-4506-8402-e312a7c6ef5f',
    sk: '01HWAJ7TSBFAR863GJZ13MXZET',
    userId: '3b59834f-caa4-4506-8402-e312a7c6ef5f',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:03:46.908Z',
    updatedAt: '2024-04-25T12:03:46.908Z',
    ttl: 1715861026,
    tk: '2024-04-25T12:03:46.908Z',
    fk: '2024-04-25T12:03:46.908Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#3b59834f-caa4-4506-8402-e312a7c6ef5f',
  sk: '01HWAJ7TSBFAR863GJZ13MXZET',
  userId: '3b59834f-caa4-4506-8402-e312a7c6ef5f',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:03:46.908Z',
  updatedAt: '2024-04-25T12:03:46.908Z',
  ttl: 1715861026,
  tk: '2024-04-25T12:03:46.908Z',
  fk: '2024-04-25T12:03:46.908Z',
  newEntity: false
}

2024-04-25T12:03:46.972Z 2024-04-25T12:03:46.972Z	c5dadf57-f335-59f8-9cc8-81f3bbe73fa0	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:03:47.006Z END RequestId: c5dadf57-f335-59f8-9cc8-81f3bbe73fa0

2024-04-25T12:03:47.006Z REPORT RequestId: c5dadf57-f335-59f8-9cc8-81f3bbe73fa0	Duration: 137.12 ms	Billed Duration: 138 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:03:47.043Z START RequestId: 0b800a74-1b3c-5777-8f07-54d053ef701c Version: $LATEST

2024-04-25T12:03:47.071Z 2024-04-25T12:03:47.071Z	0b800a74-1b3c-5777-8f07-54d053ef701c	INFO	Processing message 9e84ce07-8e09-4afc-9a31-d18120fb78e0

2024-04-25T12:03:47.079Z 2024-04-25T12:03:47.079Z	0b800a74-1b3c-5777-8f07-54d053ef701c	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ7TP3N0B1PTSJXDZFNCZT',
    type: 'DEBIT',
    source: 'MANUAL_DEDUCTION',
    action: 'DELIVERY_DEDUCTION',
    userId: '813ee3cd-2349-43ae-8915-f0a2c12b4245',
    paymentBalance: 591.045,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#813ee3cd-2349-43ae-8915-f0a2c12b4245","deliveryId":"a4314a5f-370c-4fee-ae7c-db92d4e9464d","walletSk":"a4314a5f-370c-4fee-ae7c-db92d4e9464d"}',
    currency: 'BHD',
    amount: 9,
    vat: 0,
    oldBalance: 258.045,
    newBalance: 249.045
  }
}

2024-04-25T12:03:47.100Z 2024-04-25T12:03:47.100Z	0b800a74-1b3c-5777-8f07-54d053ef701c	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#813ee3cd-2349-43ae-8915-f0a2c12b4245',
    sk: '01HWAJ7TP3N0B1PTSJXDZFNCZT',
    userId: '813ee3cd-2349-43ae-8915-f0a2c12b4245',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:03:47.080Z',
    updatedAt: '2024-04-25T12:03:47.080Z',
    ttl: 1715861027,
    tk: '2024-04-25T12:03:47.080Z',
    fk: '2024-04-25T12:03:47.080Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#813ee3cd-2349-43ae-8915-f0a2c12b4245',
  sk: '01HWAJ7TP3N0B1PTSJXDZFNCZT',
  userId: '813ee3cd-2349-43ae-8915-f0a2c12b4245',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:03:47.080Z',
  updatedAt: '2024-04-25T12:03:47.080Z',
  ttl: 1715861027,
  tk: '2024-04-25T12:03:47.080Z',
  fk: '2024-04-25T12:03:47.080Z',
  newEntity: false
}

2024-04-25T12:03:47.138Z 2024-04-25T12:03:47.138Z	0b800a74-1b3c-5777-8f07-54d053ef701c	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:03:47.151Z 2024-04-25T12:03:47.151Z	0b800a74-1b3c-5777-8f07-54d053ef701c	ERROR	Subscription balance and payment balance are not in sync {
  userId: '813ee3cd-2349-43ae-8915-f0a2c12b4245',
  subscriptionBalance: 249.045,
  paymentBalance: 591.045
}

2024-04-25T12:03:47.168Z END RequestId: 0b800a74-1b3c-5777-8f07-54d053ef701c

2024-04-25T12:03:47.168Z REPORT RequestId: 0b800a74-1b3c-5777-8f07-54d053ef701c	Duration: 124.76 ms	Billed Duration: 125 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:02:48.549Z INIT_START Runtime Version: nodejs:20.v22	Runtime Version ARN: arn:aws:lambda:us-east-1::runtime:da57c20c4b965d5b75540f6865a35fc8030358e33ec44ecfed33e90901a27a72

2024-04-25T12:02:49.527Z START RequestId: c20d1b24-2f88-54d6-949b-4580672ab3bd Version: $LATEST

2024-04-25T12:02:49.695Z 2024-04-25T12:02:49.695Z	c20d1b24-2f88-54d6-949b-4580672ab3bd	INFO	Processing message 117bafc6-ea22-4859-8c40-1322ccf3ab30

2024-04-25T12:02:49.759Z 2024-04-25T12:02:49.759Z	c20d1b24-2f88-54d6-949b-4580672ab3bd	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ60XT4ZC2QBX8M8TQQE1N',
    type: 'CREDIT',
    source: 'PAYMENT',
    action: 'CHANGE_PLAN',
    userId: '6f19e21c-ef6b-4f56-9d4d-9f17262be110',
    paymentBalance: 2535.932,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#6f19e21c-ef6b-4f56-9d4d-9f17262be110","eventSessionId":"67a3fafb-b7f8-4aa2-a6fc-0b767004277a","walletSk":"47235f53-d9fa-47e5-a480-c74729da3687","version2":true,"updateData":"{\\"paymentMethod\\":\\"cc\\",\\"useBalance\\":true,\\"startDate\\":\\"2024-04-28T13:17:56.413Z\\",\\"dietType\\":\\"weight-loss\\",\\"planType\\":\\"weightLossChallenge\\",\\"foodType\\":[\\"breakfast\\",\\"lunch\\",\\"dinner\\",\\"snack\\",\\"snack\\",\\"salad\\",\\"salad\\"],\\"frequency\\":\\"monthly\\",\\"deliveryDays\\":[0,1,2,3,4,5,6],\\"planTier\\":\\"personalized\\",\\"cardId\\":\\"card_GBpk12241114sjWT7yR3a94\\",\\"redirectUrl\\":\\"calo://account?change-plan=true\\"}","planObject":"{\\"planObj\\":{\\"id\\":\\"weightLossChallenge\\",\\"pricePerDay\\":9,\\"foodType\\":[\\"breakfast\\",\\"lunch\\",\\"dinner\\",\\"salad\\",\\"salad\\",\\"snack\\",\\"snack\\"],\\"frequency\\":\\"monthly\\",\\"dietType\\":\\"weight-loss\\"}}"}',
    currency: 'BHD',
    amount: 167.2,
    vat: 15.2,
    oldBalance: 0,
    newBalance: 152
  }
}

2024-04-25T12:02:49.841Z 2024-04-25T12:02:49.841Z	c20d1b24-2f88-54d6-949b-4580672ab3bd	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#6f19e21c-ef6b-4f56-9d4d-9f17262be110',
    sk: '01HWAJ60XT4ZC2QBX8M8TQQE1N',
    userId: '6f19e21c-ef6b-4f56-9d4d-9f17262be110',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:02:49.761Z',
    updatedAt: '2024-04-25T12:02:49.761Z',
    ttl: 1715860969,
    tk: '2024-04-25T12:02:49.762Z',
    fk: '2024-04-25T12:02:49.762Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#6f19e21c-ef6b-4f56-9d4d-9f17262be110',
  sk: '01HWAJ60XT4ZC2QBX8M8TQQE1N',
  userId: '6f19e21c-ef6b-4f56-9d4d-9f17262be110',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:02:49.761Z',
  updatedAt: '2024-04-25T12:02:49.761Z',
  ttl: 1715860969,
  tk: '2024-04-25T12:02:49.762Z',
  fk: '2024-04-25T12:02:49.762Z',
  newEntity: false
}

2024-04-25T12:02:49.911Z 2024-04-25T12:02:49.911Z	c20d1b24-2f88-54d6-949b-4580672ab3bd	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:02:49.964Z 2024-04-25T12:02:49.964Z	c20d1b24-2f88-54d6-949b-4580672ab3bd	ERROR	Subscription balance and payment balance are not in sync {
  userId: '6f19e21c-ef6b-4f56-9d4d-9f17262be110',
  subscriptionBalance: 152,
  paymentBalance: 2535.932
}

2024-04-25T12:02:49.985Z END RequestId: c20d1b24-2f88-54d6-949b-4580672ab3bd

2024-04-25T12:02:49.985Z REPORT RequestId: c20d1b24-2f88-54d6-949b-4580672ab3bd	Duration: 459.88 ms	Billed Duration: 460 ms	Memory Size: 1024 MB	Max Memory Used: 117 MB	Init Duration: 975.37 ms	
XRAY TraceId: 1-662a4668-8db2a85bedf3e68938574fa0	SegmentId: 0606b94908da82da	Sampled: true	

2024-04-25T12:04:20.654Z START RequestId: 252e7441-e82a-55f6-bdbd-2ae5a0dfb29d Version: $LATEST

2024-04-25T12:04:20.688Z 2024-04-25T12:04:20.688Z	252e7441-e82a-55f6-bdbd-2ae5a0dfb29d	INFO	Processing message c1f42f2f-4fa4-448b-97d1-fb2fa1bd0960

2024-04-25T12:04:20.688Z 2024-04-25T12:04:20.688Z	252e7441-e82a-55f6-bdbd-2ae5a0dfb29d	INFO	Skipping the balance sync for create subscription, it will be synced from create subscription payment listener

2024-04-25T12:04:20.690Z END RequestId: 252e7441-e82a-55f6-bdbd-2ae5a0dfb29d

2024-04-25T12:04:20.690Z REPORT RequestId: 252e7441-e82a-55f6-bdbd-2ae5a0dfb29d	Duration: 35.31 ms	Billed Duration: 36 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:22.664Z START RequestId: 70590a79-5585-5a4a-8e9b-54dd1d734c12 Version: $LATEST

2024-04-25T12:04:22.695Z 2024-04-25T12:04:22.695Z	70590a79-5585-5a4a-8e9b-54dd1d734c12	INFO	Processing message 66b04e28-b9a5-4f95-8d0b-098f21491a80

2024-04-25T12:04:22.701Z 2024-04-25T12:04:22.701Z	70590a79-5585-5a4a-8e9b-54dd1d734c12	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ8XQ8FQ25GF8JMEX5DTNC',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'COMPENSATION',
    userId: 'f3d4c61b-6917-4a7c-99c0-aaa26571e99e',
    paymentBalance: 127.181,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#f3d4c61b-6917-4a7c-99c0-aaa26571e99e","walletSk":"7a0dc64e-eb09-4911-ad96-4566b928adda"}',
    currency: 'BHD',
    amount: 9.091,
    vat: 0,
    oldBalance: 118.09,
    newBalance: 127.181
  }
}

2024-04-25T12:04:22.712Z 2024-04-25T12:04:22.712Z	70590a79-5585-5a4a-8e9b-54dd1d734c12	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#f3d4c61b-6917-4a7c-99c0-aaa26571e99e',
    sk: '01HWAJ8XQ8FQ25GF8JMEX5DTNC',
    userId: 'f3d4c61b-6917-4a7c-99c0-aaa26571e99e',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:22.701Z',
    updatedAt: '2024-04-25T12:04:22.701Z',
    ttl: 1715861062,
    tk: '2024-04-25T12:04:22.701Z',
    fk: '2024-04-25T12:04:22.701Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#f3d4c61b-6917-4a7c-99c0-aaa26571e99e',
  sk: '01HWAJ8XQ8FQ25GF8JMEX5DTNC',
  userId: 'f3d4c61b-6917-4a7c-99c0-aaa26571e99e',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:22.701Z',
  updatedAt: '2024-04-25T12:04:22.701Z',
  ttl: 1715861062,
  tk: '2024-04-25T12:04:22.701Z',
  fk: '2024-04-25T12:04:22.701Z',
  newEntity: false
}

2024-04-25T12:04:22.762Z 2024-04-25T12:04:22.762Z	70590a79-5585-5a4a-8e9b-54dd1d734c12	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:22.798Z END RequestId: 70590a79-5585-5a4a-8e9b-54dd1d734c12

2024-04-25T12:04:22.798Z REPORT RequestId: 70590a79-5585-5a4a-8e9b-54dd1d734c12	Duration: 133.63 ms	Billed Duration: 134 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:23.660Z START RequestId: 84a69449-8618-5ec0-88d8-caedceee70f0 Version: $LATEST

2024-04-25T12:04:23.685Z 2024-04-25T12:04:23.685Z	84a69449-8618-5ec0-88d8-caedceee70f0	INFO	Processing message 5b8184c3-7256-4eaa-953d-0d13ec062aa0

2024-04-25T12:04:23.691Z 2024-04-25T12:04:23.691Z	84a69449-8618-5ec0-88d8-caedceee70f0	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ8YF6X3D2YAW1265WY5WK',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'CX_GIFT',
    userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    paymentBalance: 125.999,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#9e652ba2-e1f3-4c64-a256-7bc39337e0ca","walletSk":"0d62ee8d-e8f9-4b68-82cd-fbee19b82a77"}',
    currency: 'BHD',
    amount: 9.091,
    vat: 0,
    oldBalance: 116.908,
    newBalance: 125.999
  }
}

2024-04-25T12:04:23.702Z 2024-04-25T12:04:23.702Z	84a69449-8618-5ec0-88d8-caedceee70f0	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    sk: '01HWAJ8YF6X3D2YAW1265WY5WK',
    userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:23.692Z',
    updatedAt: '2024-04-25T12:04:23.692Z',
    ttl: 1715861063,
    tk: '2024-04-25T12:04:23.692Z',
    fk: '2024-04-25T12:04:23.692Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
  sk: '01HWAJ8YF6X3D2YAW1265WY5WK',
  userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:23.692Z',
  updatedAt: '2024-04-25T12:04:23.692Z',
  ttl: 1715861063,
  tk: '2024-04-25T12:04:23.692Z',
  fk: '2024-04-25T12:04:23.692Z',
  newEntity: false
}

2024-04-25T12:04:23.743Z 2024-04-25T12:04:23.743Z	84a69449-8618-5ec0-88d8-caedceee70f0	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:23.759Z END RequestId: 84a69449-8618-5ec0-88d8-caedceee70f0

2024-04-25T12:04:23.759Z REPORT RequestId: 84a69449-8618-5ec0-88d8-caedceee70f0	Duration: 99.74 ms	Billed Duration: 100 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:23.791Z START RequestId: 5f3c2346-1cd1-52e3-9599-7de255d5341f Version: $LATEST

2024-04-25T12:04:23.826Z 2024-04-25T12:04:23.826Z	5f3c2346-1cd1-52e3-9599-7de255d5341f	INFO	Processing message 2c4a58d5-924c-4461-918f-47415dc92ddb

2024-04-25T12:04:23.832Z 2024-04-25T12:04:23.832Z	5f3c2346-1cd1-52e3-9599-7de255d5341f	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ8YPA3ZJRPE9NAXRM678D',
    type: 'DEBIT',
    source: 'MANUAL_DEDUCTION',
    action: 'INVAILID_ENTRY',
    userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    paymentBalance: 36.908,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#9e652ba2-e1f3-4c64-a256-7bc39337e0ca","walletSk":"b27f95b5-da4e-4d3e-8a07-bdbd864b1cdc"}',
    currency: 'BHD',
    amount: 89.091,
    vat: 0,
    oldBalance: 125.999,
    newBalance: 36.908
  }
}

2024-04-25T12:04:23.844Z 2024-04-25T12:04:23.844Z	5f3c2346-1cd1-52e3-9599-7de255d5341f	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    sk: '01HWAJ8YPA3ZJRPE9NAXRM678D',
    userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:23.832Z',
    updatedAt: '2024-04-25T12:04:23.832Z',
    ttl: 1715861063,
    tk: '2024-04-25T12:04:23.832Z',
    fk: '2024-04-25T12:04:23.832Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
  sk: '01HWAJ8YPA3ZJRPE9NAXRM678D',
  userId: '9e652ba2-e1f3-4c64-a256-7bc39337e0ca',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:23.832Z',
  updatedAt: '2024-04-25T12:04:23.832Z',
  ttl: 1715861063,
  tk: '2024-04-25T12:04:23.832Z',
  fk: '2024-04-25T12:04:23.832Z',
  newEntity: false
}

2024-04-25T12:04:23.877Z 2024-04-25T12:04:23.877Z	5f3c2346-1cd1-52e3-9599-7de255d5341f	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:23.890Z END RequestId: 5f3c2346-1cd1-52e3-9599-7de255d5341f

2024-04-25T12:04:23.890Z REPORT RequestId: 5f3c2346-1cd1-52e3-9599-7de255d5341f	Duration: 99.35 ms	Billed Duration: 100 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:03:25.787Z START RequestId: 60a414f2-2cd5-570e-a7d3-4a56646ad065 Version: $LATEST

2024-04-25T12:03:25.859Z 2024-04-25T12:03:25.859Z	60a414f2-2cd5-570e-a7d3-4a56646ad065	INFO	Processing message f62dc4b2-84f9-4b2a-8a57-7cbce23aca51

2024-04-25T12:03:25.876Z 2024-04-25T12:03:25.876Z	60a414f2-2cd5-570e-a7d3-4a56646ad065	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ761CDFEH4MWKXKQ2RFQE',
    type: 'DEBIT',
    source: 'MANUAL_DEDUCTION',
    action: 'DELIVERY_DEDUCTION',
    userId: 'd5aae41c-e806-48f6-a980-25f322899a4a',
    paymentBalance: 3060.44,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#d5aae41c-e806-48f6-a980-25f322899a4a","deliveryId":"d85d7ac7-4a8e-4b14-afef-2281dd4e3f85","walletSk":"d85d7ac7-4a8e-4b14-afef-2281dd4e3f85"}',
    currency: 'SAR',
    amount: 90,
    vat: 0,
    oldBalance: 1440.44,
    newBalance: 1350.44
  }
}

2024-04-25T12:03:25.900Z 2024-04-25T12:03:25.900Z	60a414f2-2cd5-570e-a7d3-4a56646ad065	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#d5aae41c-e806-48f6-a980-25f322899a4a',
    sk: '01HWAJ761CDFEH4MWKXKQ2RFQE',
    userId: 'd5aae41c-e806-48f6-a980-25f322899a4a',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:03:25.877Z',
    updatedAt: '2024-04-25T12:03:25.877Z',
    ttl: 1715861005,
    tk: '2024-04-25T12:03:25.877Z',
    fk: '2024-04-25T12:03:25.877Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#d5aae41c-e806-48f6-a980-25f322899a4a',
  sk: '01HWAJ761CDFEH4MWKXKQ2RFQE',
  userId: 'd5aae41c-e806-48f6-a980-25f322899a4a',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:03:25.877Z',
  updatedAt: '2024-04-25T12:03:25.877Z',
  ttl: 1715861005,
  tk: '2024-04-25T12:03:25.877Z',
  fk: '2024-04-25T12:03:25.877Z',
  newEntity: false
}

2024-04-25T12:03:25.966Z 2024-04-25T12:03:25.966Z	60a414f2-2cd5-570e-a7d3-4a56646ad065	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:03:25.998Z 2024-04-25T12:03:25.998Z	60a414f2-2cd5-570e-a7d3-4a56646ad065	ERROR	Subscription balance and payment balance are not in sync {
  userId: 'd5aae41c-e806-48f6-a980-25f322899a4a',
  subscriptionBalance: 1350.44,
  paymentBalance: 3060.44
}

2024-04-25T12:03:26.018Z END RequestId: 60a414f2-2cd5-570e-a7d3-4a56646ad065

2024-04-25T12:03:26.018Z REPORT RequestId: 60a414f2-2cd5-570e-a7d3-4a56646ad065	Duration: 231.47 ms	Billed Duration: 232 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:02.079Z START RequestId: 0e8da91d-d830-51eb-bd7f-f7b990d2b717 Version: $LATEST

2024-04-25T12:04:02.110Z 2024-04-25T12:04:02.110Z	0e8da91d-d830-51eb-bd7f-f7b990d2b717	INFO	Processing message 9d0d8d40-07bb-4634-b346-4305c5998c7a

2024-04-25T12:04:02.110Z 2024-04-25T12:04:02.110Z	0e8da91d-d830-51eb-bd7f-f7b990d2b717	INFO	Skipping the balance sync for create subscription, it will be synced from create subscription payment listener

2024-04-25T12:04:02.112Z END RequestId: 0e8da91d-d830-51eb-bd7f-f7b990d2b717

2024-04-25T12:04:02.112Z REPORT RequestId: 0e8da91d-d830-51eb-bd7f-f7b990d2b717	Duration: 32.41 ms	Billed Duration: 33 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:05.851Z START RequestId: 497bc367-9257-5bb7-b08b-9dc3dab53def Version: $LATEST

2024-04-25T12:04:05.890Z 2024-04-25T12:04:05.890Z	497bc367-9257-5bb7-b08b-9dc3dab53def	INFO	Processing message 850881e1-4a47-4cda-b76e-dd3f3b1ff361

2024-04-25T12:04:05.896Z 2024-04-25T12:04:05.896Z	497bc367-9257-5bb7-b08b-9dc3dab53def	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ8D0DMTMEF0TX3RHTPAA0',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'DELIVERY_CANCELLATION',
    userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    paymentBalance: 188.492,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#ada642e4-bef1-4fd9-8b93-7f3f3813ae19","deliveryId":"af410e12-46ad-4868-ab9a-928a0a8ce61e","walletSk":"f44bc594-7cce-46a2-b635-bff8fe54661f"}',
    currency: 'BHD',
    amount: 8,
    vat: 0,
    oldBalance: 196.492,
    newBalance: 204.492
  }
}

2024-04-25T12:04:05.908Z 2024-04-25T12:04:05.908Z	497bc367-9257-5bb7-b08b-9dc3dab53def	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    sk: '01HWAJ8D0DMTMEF0TX3RHTPAA0',
    userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:05.896Z',
    updatedAt: '2024-04-25T12:04:05.896Z',
    ttl: 1715861045,
    tk: '2024-04-25T12:04:05.896Z',
    fk: '2024-04-25T12:04:05.896Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  sk: '01HWAJ8D0DMTMEF0TX3RHTPAA0',
  userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:05.896Z',
  updatedAt: '2024-04-25T12:04:05.896Z',
  ttl: 1715861045,
  tk: '2024-04-25T12:04:05.896Z',
  fk: '2024-04-25T12:04:05.896Z',
  newEntity: false
}

2024-04-25T12:04:05.960Z 2024-04-25T12:04:05.960Z	497bc367-9257-5bb7-b08b-9dc3dab53def	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:05.998Z 2024-04-25T12:04:05.998Z	497bc367-9257-5bb7-b08b-9dc3dab53def	ERROR	Subscription balance and payment balance are not in sync {
  userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  subscriptionBalance: 204.492,
  paymentBalance: 188.492
}

2024-04-25T12:04:06.026Z END RequestId: 497bc367-9257-5bb7-b08b-9dc3dab53def

2024-04-25T12:04:06.026Z REPORT RequestId: 497bc367-9257-5bb7-b08b-9dc3dab53def	Duration: 174.18 ms	Billed Duration: 175 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:06.048Z START RequestId: 9df969bb-efc4-51a8-a786-371fa7364754 Version: $LATEST

2024-04-25T12:04:06.081Z 2024-04-25T12:04:06.081Z	9df969bb-efc4-51a8-a786-371fa7364754	INFO	Processing message 54a5ee3a-3bc8-4097-8f5a-80eb4e12d0f9

2024-04-25T12:04:06.087Z 2024-04-25T12:04:06.087Z	9df969bb-efc4-51a8-a786-371fa7364754	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ8D6BJFRXJSN043KBACKS',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'DELIVERY_CANCELLATION',
    userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    paymentBalance: 197.492,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#ada642e4-bef1-4fd9-8b93-7f3f3813ae19","deliveryId":"217fe3cc-cda6-48ab-8e94-749d85bda8cb","walletSk":"db7a0b99-592c-407c-a860-642ede9d00af"}',
    currency: 'BHD',
    amount: 9,
    vat: 0,
    oldBalance: 204.492,
    newBalance: 213.492
  }
}

2024-04-25T12:04:06.113Z 2024-04-25T12:04:06.113Z	9df969bb-efc4-51a8-a786-371fa7364754	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    sk: '01HWAJ8D6BJFRXJSN043KBACKS',
    userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:06.087Z',
    updatedAt: '2024-04-25T12:04:06.087Z',
    ttl: 1715861046,
    tk: '2024-04-25T12:04:06.087Z',
    fk: '2024-04-25T12:04:06.087Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  sk: '01HWAJ8D6BJFRXJSN043KBACKS',
  userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:06.087Z',
  updatedAt: '2024-04-25T12:04:06.087Z',
  ttl: 1715861046,
  tk: '2024-04-25T12:04:06.087Z',
  fk: '2024-04-25T12:04:06.087Z',
  newEntity: false
}

2024-04-25T12:04:06.144Z 2024-04-25T12:04:06.144Z	9df969bb-efc4-51a8-a786-371fa7364754	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:06.158Z 2024-04-25T12:04:06.158Z	9df969bb-efc4-51a8-a786-371fa7364754	ERROR	Subscription balance and payment balance are not in sync {
  userId: 'ada642e4-bef1-4fd9-8b93-7f3f3813ae19',
  subscriptionBalance: 213.492,
  paymentBalance: 197.492
}

2024-04-25T12:04:06.175Z END RequestId: 9df969bb-efc4-51a8-a786-371fa7364754

2024-04-25T12:04:06.175Z REPORT RequestId: 9df969bb-efc4-51a8-a786-371fa7364754	Duration: 127.12 ms	Billed Duration: 128 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:40.275Z START RequestId: 321bac51-f697-5106-94cd-f2f5bf8527fa Version: $LATEST

2024-04-25T12:04:40.337Z 2024-04-25T12:04:40.337Z	321bac51-f697-5106-94cd-f2f5bf8527fa	INFO	Processing message 5b8da4f2-762c-4dc3-8adb-02cc7bb74968

2024-04-25T12:04:40.352Z 2024-04-25T12:04:40.352Z	321bac51-f697-5106-94cd-f2f5bf8527fa	INFO	Skipping the balance sync for create subscription, it will be synced from create subscription payment listener

2024-04-25T12:04:40.354Z END RequestId: 321bac51-f697-5106-94cd-f2f5bf8527fa

2024-04-25T12:04:40.354Z REPORT RequestId: 321bac51-f697-5106-94cd-f2f5bf8527fa	Duration: 79.61 ms	Billed Duration: 80 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:40.379Z START RequestId: 9c9906d1-4892-5126-a587-58750180ca81 Version: $LATEST

2024-04-25T12:04:40.406Z 2024-04-25T12:04:40.406Z	9c9906d1-4892-5126-a587-58750180ca81	INFO	Processing message 85998645-2ee9-46ef-9789-c62cbd7e623f

2024-04-25T12:04:40.413Z 2024-04-25T12:04:40.413Z	9c9906d1-4892-5126-a587-58750180ca81	INFO	Start syncing the balance {
  transaction: {
    id: '01HWA9FSW3GJWVV4NRH5CXV987',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'CUSTOMERS_CALO_EXPERIMENTS',
    userId: '44f3e582-82d7-4e4f-b425-518f85bdf705',
    paymentBalance: 252,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#44f3e582-82d7-4e4f-b425-518f85bdf705","walletSk":"a12ae28d-4721-4ae6-b656-d2e7708b94eb"}',
    currency: 'BHD',
    amount: 25.2,
    vat: 0,
    oldBalance: 226.8,
    newBalance: 252
  }
}

2024-04-25T12:04:40.425Z 2024-04-25T12:04:40.425Z	9c9906d1-4892-5126-a587-58750180ca81	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#44f3e582-82d7-4e4f-b425-518f85bdf705',
    sk: '01HWA9FSW3GJWVV4NRH5CXV987',
    userId: '44f3e582-82d7-4e4f-b425-518f85bdf705',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:40.413Z',
    updatedAt: '2024-04-25T12:04:40.413Z',
    ttl: 1715861080,
    tk: '2024-04-25T12:04:40.413Z',
    fk: '2024-04-25T12:04:40.413Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#44f3e582-82d7-4e4f-b425-518f85bdf705',
  sk: '01HWA9FSW3GJWVV4NRH5CXV987',
  userId: '44f3e582-82d7-4e4f-b425-518f85bdf705',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:40.413Z',
  updatedAt: '2024-04-25T12:04:40.413Z',
  ttl: 1715861080,
  tk: '2024-04-25T12:04:40.413Z',
  fk: '2024-04-25T12:04:40.413Z',
  newEntity: false
}

2024-04-25T12:04:40.472Z 2024-04-25T12:04:40.472Z	9c9906d1-4892-5126-a587-58750180ca81	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:40.511Z END RequestId: 9c9906d1-4892-5126-a587-58750180ca81

2024-04-25T12:04:40.511Z REPORT RequestId: 9c9906d1-4892-5126-a587-58750180ca81	Duration: 131.51 ms	Billed Duration: 132 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:43.955Z START RequestId: d6f95c53-6585-5a6a-8413-02f72c9d0c96 Version: $LATEST

2024-04-25T12:04:43.990Z 2024-04-25T12:04:43.990Z	d6f95c53-6585-5a6a-8413-02f72c9d0c96	INFO	Processing message 2edd1dfd-a47f-429c-a06f-8b0cc4733969

2024-04-25T12:04:43.997Z 2024-04-25T12:04:43.997Z	d6f95c53-6585-5a6a-8413-02f72c9d0c96	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ9JD7NH9D5WHKKC61RMMA',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'MANUAL_DISCOUNT',
    userId: '67c42c0a-38dc-4917-b323-f8e7e0a5e9cb',
    paymentBalance: 10066.454,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#67c42c0a-38dc-4917-b323-f8e7e0a5e9cb","walletSk":"97096325-e392-431f-b31d-6e70016e2fac"}',
    currency: 'BHD',
    amount: 9.091,
    vat: 0,
    oldBalance: 10057.363,
    newBalance: 10066.454
  }
}

2024-04-25T12:04:44.014Z 2024-04-25T12:04:44.014Z	d6f95c53-6585-5a6a-8413-02f72c9d0c96	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#67c42c0a-38dc-4917-b323-f8e7e0a5e9cb',
    sk: '01HWAJ9JD7NH9D5WHKKC61RMMA',
    userId: '67c42c0a-38dc-4917-b323-f8e7e0a5e9cb',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:43.997Z',
    updatedAt: '2024-04-25T12:04:43.997Z',
    ttl: 1715861083,
    tk: '2024-04-25T12:04:43.997Z',
    fk: '2024-04-25T12:04:43.997Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#67c42c0a-38dc-4917-b323-f8e7e0a5e9cb',
  sk: '01HWAJ9JD7NH9D5WHKKC61RMMA',
  userId: '67c42c0a-38dc-4917-b323-f8e7e0a5e9cb',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:43.997Z',
  updatedAt: '2024-04-25T12:04:43.997Z',
  ttl: 1715861083,
  tk: '2024-04-25T12:04:43.997Z',
  fk: '2024-04-25T12:04:43.997Z',
  newEntity: false
}

2024-04-25T12:04:44.049Z 2024-04-25T12:04:44.049Z	d6f95c53-6585-5a6a-8413-02f72c9d0c96	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:44.068Z END RequestId: d6f95c53-6585-5a6a-8413-02f72c9d0c96

2024-04-25T12:04:44.068Z REPORT RequestId: d6f95c53-6585-5a6a-8413-02f72c9d0c96	Duration: 112.88 ms	Billed Duration: 113 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-25T12:04:44.187Z START RequestId: f86a9327-ef28-580a-ad3e-cd83a6332e52 Version: $LATEST

2024-04-25T12:04:44.216Z 2024-04-25T12:04:44.216Z	f86a9327-ef28-580a-ad3e-cd83a6332e52	INFO	Processing message c3463c9e-d4b6-419f-8479-f0541013360c

2024-04-25T12:04:44.224Z 2024-04-25T12:04:44.224Z	f86a9327-ef28-580a-ad3e-cd83a6332e52	INFO	Start syncing the balance {
  transaction: {
    id: '01HWAJ9JNK2AHMF5JRGW2ZMEJC',
    type: 'CREDIT',
    source: 'MANUAL_ADDITION',
    action: 'CALO_TEAM_PERKS',
    userId: '5cf444b8-09b4-4a03-b22d-f3141a817dd8',
    paymentBalance: 112.817,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#5cf444b8-09b4-4a03-b22d-f3141a817dd8","walletSk":"09564c6c-b8f5-4d23-a21c-ae4966b4c30c"}',
    currency: 'BHD',
    amount: 9.091,
    vat: 0,
    oldBalance: 111.726,
    newBalance: 120.817
  }
}

2024-04-25T12:04:44.234Z 2024-04-25T12:04:44.234Z	f86a9327-ef28-580a-ad3e-cd83a6332e52	INFO	Transaction Lock created!!!!!!!!!!!!!!!!!!!!!!!!!!! Rr {
  dirty: {},
  original: {
    id: 'trxLock#5cf444b8-09b4-4a03-b22d-f3141a817dd8',
    sk: '01HWAJ9JNK2AHMF5JRGW2ZMEJC',
    userId: '5cf444b8-09b4-4a03-b22d-f3141a817dd8',
    dataType: 'trxLock',
    createdAt: '2024-04-25T12:04:44.224Z',
    updatedAt: '2024-04-25T12:04:44.224Z',
    ttl: 1715861084,
    tk: '2024-04-25T12:04:44.224Z',
    fk: '2024-04-25T12:04:44.224Z'
  },
  attributes: [
    'id',        'sk',
    'userId',    'dataType',
    'createdAt', 'updatedAt',
    'ttl',       'tk',
    'fk'
  ],
  id: 'trxLock#5cf444b8-09b4-4a03-b22d-f3141a817dd8',
  sk: '01HWAJ9JNK2AHMF5JRGW2ZMEJC',
  userId: '5cf444b8-09b4-4a03-b22d-f3141a817dd8',
  dataType: 'trxLock',
  createdAt: '2024-04-25T12:04:44.224Z',
  updatedAt: '2024-04-25T12:04:44.224Z',
  ttl: 1715861084,
  tk: '2024-04-25T12:04:44.224Z',
  fk: '2024-04-25T12:04:44.224Z',
  newEntity: false
}

2024-04-25T12:04:44.272Z 2024-04-25T12:04:44.272Z	f86a9327-ef28-580a-ad3e-cd83a6332e52	INFO	SubscriptionBalanceUpdated event published

2024-04-25T12:04:44.283Z 2024-04-25T12:04:44.283Z	f86a9327-ef28-580a-ad3e-cd83a6332e52	ERROR	Subscription balance and payment balance are not in sync {
  userId: '5cf444b8-09b4-4a03-b22d-f3141a817dd8',
  subscriptionBalance: 120.817,
  paymentBalance: 112.817
}

2024-04-25T12:04:44.301Z END RequestId: f86a9327-ef28-580a-ad3e-cd83a6332e52

2024-04-25T12:04:44.301Z REPORT RequestId: f86a9327-ef28-580a-ad3e-cd83a6332e52	Duration: 113.56 ms	Billed Duration: 114 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

