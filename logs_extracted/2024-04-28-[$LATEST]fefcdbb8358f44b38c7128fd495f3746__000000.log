2024-04-28T16:56:48.260Z START RequestId: b3fb59be-35ac-50d6-8021-0716b7aa21c2 Version: $LATEST

2024-04-28T16:56:48.413Z 2024-04-28T16:56:48.413Z	b3fb59be-35ac-50d6-8021-0716b7aa21c2	INFO	Processing message f53acbde-1437-4751-8636-193a2c150714

2024-04-28T16:56:48.443Z 2024-04-28T16:56:48.443Z	b3fb59be-35ac-50d6-8021-0716b7aa21c2	INFO	Start syncing the balance {
  transaction: {
    id: '01HWJT6GN8KEN72BDXWMDZX8Y5',
    type: 'CREDIT',
    source: 'PAYMENT',
    action: 'PAY_PENDING_AMOUNT',
    userId: '482cd140-b381-4122-bcdc-b74fedd083f6',
    paymentBalance: 280,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#482cd140-b381-4122-bcdc-b74fedd083f6","eventSessionId":"79c890c8-9902-4440-9b22-788725bba1bc","walletSk":"4f13004c-05f5-425e-9ffc-8947c80a029b","version2":true}',
    currency: 'BHD',
    amount: 110,
    vat: 10,
    oldBalance: 180,
    newBalance: 280
  }
}

2024-04-28T16:56:48.522Z 2024-04-28T16:56:48.522Z	b3fb59be-35ac-50d6-8021-0716b7aa21c2	INFO	SubscriptionBalanceUpdated event published

2024-04-28T16:56:48.556Z END RequestId: b3fb59be-35ac-50d6-8021-0716b7aa21c2

2024-04-28T16:56:48.556Z REPORT RequestId: b3fb59be-35ac-50d6-8021-0716b7aa21c2	Duration: 295.93 ms	Billed Duration: 296 ms	Memory Size: 1024 MB	Max Memory Used: 126 MB	

2024-04-28T16:51:19.571Z INIT_START Runtime Version: nodejs:20.v22	Runtime Version ARN: arn:aws:lambda:us-east-1::runtime:da57c20c4b965d5b75540f6865a35fc8030358e33ec44ecfed33e90901a27a72

2024-04-28T16:51:20.584Z START RequestId: db6e6598-b88f-5e1a-9c4b-3b303837c11e Version: $LATEST

2024-04-28T16:51:20.740Z 2024-04-28T16:51:20.740Z	db6e6598-b88f-5e1a-9c4b-3b303837c11e	INFO	Processing message 17506f5b-db3b-46b6-a89a-95c5130d5881

2024-04-28T16:51:20.788Z 2024-04-28T16:51:20.788Z	db6e6598-b88f-5e1a-9c4b-3b303837c11e	INFO	Start syncing the balance {
  transaction: {
    id: '01HWJSWF89AF8QM84A8Z85D7HK',
    type: 'CREDIT',
    source: 'PAYMENT',
    action: 'CHANGE_PLAN',
    userId: 'f3a186d2-d38f-4c2a-ab55-9f26e0ef1e43',
    paymentBalance: 900,
    updatePaymentBalance: true,
    metadata: '{"walletId":"wallet#f3a186d2-d38f-4c2a-ab55-9f26e0ef1e43","eventSessionId":"3fb9477c-2064-489c-8d05-894e58cf8d70","walletSk":"33bc1b68-7662-4da0-95f7-502e856a9f2b","version2":true,"updateData":"{\\"paymentMethod\\":\\"cc\\",\\"useBalance\\":true,\\"startDate\\":\\"2024-04-30T16:49:54.534Z\\",\\"dietType\\":\\"weight-loss\\",\\"planType\\":\\"weightLossChallenge\\",\\"foodType\\":[\\"breakfast\\",\\"lunch\\",\\"dinner\\",\\"snack\\",\\"snack\\",\\"salad\\",\\"salad\\"],\\"frequency\\":\\"monthly\\",\\"deliveryDays\\":[0,1,2,3,4,5,6],\\"planTier\\":\\"personalized\\",\\"redirectUrl\\":\\"calo://account?change-plan=true\\"}","planObject":"{\\"id\\":\\"weightLossChallenge\\",\\"pricePerDay\\":9,\\"foodType\\":[\\"breakfast\\",\\"lunch\\",\\"dinner\\",\\"salad\\",\\"salad\\",\\"snack\\",\\"snack\\"],\\"frequency\\":\\"monthly\\",\\"dietType\\":\\"weight-loss\\"}"}',
    currency: 'BHD',
    amount: 79.2,
    vat: 7.2,
    oldBalance: 180,
    newBalance: 252
  }
}

2024-04-28T16:51:20.894Z 2024-04-28T16:51:20.894Z	db6e6598-b88f-5e1a-9c4b-3b303837c11e	INFO	SubscriptionBalanceUpdated event published

2024-04-28T16:51:20.929Z 2024-04-28T16:51:20.929Z	db6e6598-b88f-5e1a-9c4b-3b303837c11e	ERROR	Subscription balance and payment balance are not in sync {
  userId: 'f3a186d2-d38f-4c2a-ab55-9f26e0ef1e43',
  subscriptionBalance: 252,
  paymentBalance: 900
}

2024-04-28T16:51:20.966Z END RequestId: db6e6598-b88f-5e1a-9c4b-3b303837c11e

2024-04-28T16:51:20.966Z REPORT RequestId: db6e6598-b88f-5e1a-9c4b-3b303837c11e	Duration: 381.57 ms	Billed Duration: 382 ms	Memory Size: 1024 MB	Max Memory Used: 118 MB	Init Duration: 1012.50 ms	

